---
title: "Avances,Lab1"
author: 'Andrés Mazariegos,June Herrera,Daniel Sarmiento '
date: "2026-02-02"
output:
  word_document: default
  html_document: default
  pdf_document: default
editor_options:
  markdown:
    wrap: sentence
---

***1. (3 puntos) Haga una exploración rápida de sus datos, para eso haga un resumen de su conjunto de datos***

```{r 1}
##Leemos la data y lo asignamos a una variable 
movies <- read.csv("movies_2026.csv",fileEncoding = "UTF-8-BOM")
##el nombre de las columnas 
colnames(movies )

##summary
summary(movies)
str(movies)
```

***2. (5 puntos) Diga el tipo de cada una de las variables (cualitativa ordinal o nominal, cuantitativa continua, cuantitativa discreta***

```{r 2}


clasificacion_variables <- data.frame(
  Variable = c(
    "id", "budget", "genres", "homePage", "productionCompany", 
    "productionCompanyCountry", "productionCountry", "revenue", "runtime", "video", 
    "director", "actors", "actorsPopularity", "actorsCharacter", "originalTitle", 
    "title", "originalLanguage", "popularity", "releaseDate", "voteAvg", 
    "voteCount", "genresAmount", "productionCoAmount", "productionCountriesAmount", "actorsAmount", 
    "castWomenAmount", "castMenAmount", "releaseYear"
  ),
  Tipo = c(
    "Cualitativa categórica (ID)", "Cuantitativa continua", "Cualitativa categórica", "Cualitativa categórica", "Cualitativa categórica",
    "Cualitativa categórica", "Cualitativa categórica", "Cuantitativa continua", "Cuantitativa continua", "Cualitativa categórica (binaria)",
    "Cualitativa categórica", "Cualitativa categórica", "Cualitativa categórica", "Cualitativa categórica", "Cualitativa categórica",
    "Cualitativa categórica", "Cualitativa categórica", "Cuantitativa continua", "Cualitativa categórica", "Cuantitativa continua",
    "Cuantitativa discreta", "Cuantitativa discreta", "Cuantitativa discreta", "Cuantitativa discreta", "Cuantitativa discreta",
    "Cuantitativa discreta", "Cuantitativa discreta", "Cuantitativa discreta"
  ),
  stringsAsFactors = FALSE
)

# Para visualizar la tabla completa
print(clasificacion_variables)


```

***3. (6 puntos) Investigue si las variables cuantitativas siguen una distribución normal y haga una tabla de frecuencias de las variables cualitativas. Explique todos los resultados.***

a)Variables Cualitativas

```{r 3}


# 1) Seleccionar únicamente las columnas numéricas (cuantitativas)
# sapply(movies_2026, is.numeric) devuelve TRUE/FALSE por columna
# y con eso filtramos las columnas numéricas.
vars_num <- movies[, sapply(movies, is.numeric)]

# 2) Crear una tabla donde guardaremos los resultados
# variable: nombre de la columna
# n: cantidad de valores NO-NA (datos válidos) que tiene esa variable
# p_value: valor p del test de Shapiro–Wilk
# normal: TRUE si p_value > 0.05, FALSE si p_value <= 0.05
normalidad <- data.frame(
  variable = names(vars_num),
  n = NA,
  p_value = NA,
  normal = NA
)

# 3) Fijar una semilla para reproducibilidad
# Esto hace que sample() seleccione siempre la misma muestra si vuelves a correr el script.
set.seed(1)

# 4) Recorrer cada variable numérica y aplicar el test
for (i in seq_along(vars_num)) {

  # 4.1) Tomar la columna i y quitar NAs
  # na.omit elimina valores faltantes para evitar errores en la prueba
  x <- na.omit(vars_num[[i]])

  # Guardar cuántos datos válidos tiene la variable (antes de muestrear)
  normalidad$n[i] <- length(x)

  # 4.2) Validaciones mínimas antes de correr Shapiro
  # - Shapiro necesita al menos 3 observaciones
  if (length(x) < 3) next

  # - Si todos los valores son iguales (varianza = 0), no tiene sentido probar normalidad
  #   porque no hay distribución "real" que evaluar
  if (length(unique(x)) < 2) next

  # 4.3) Shapiro–Wilk solo permite hasta 5000 observaciones
  # Si hay más, tomamos una muestra aleatoria de 5000 para poder correr el test
  if (length(x) > 5000) {
    x <- sample(x, 5000)
  }

  # 4.4) Ejecutar Shapiro de forma segura
  # tryCatch evita que el script se detenga si una variable causa error
  out <- tryCatch(
    shapiro.test(x),
    error = function(e) NULL
  )

  # 4.5) Si la prueba se ejecutó bien, guardamos resultados
  if (!is.null(out)) {

    # Guardar valor p del test
    normalidad$p_value[i] <- out$p.value

    # Decisión simple:
    # p_value > 0.05  -> "compatible con normalidad" (no rechazo H0)
    # p_value <= 0.05 -> "no normal" (rechazo H0)
    normalidad$normal[i] <- out$p.value > 0.05
  }
}

# 5) Mostrar la tabla final con resultados de normalidad
normalidad
```

Para evaluar si las variables cuantitativas del conjunto de datos siguen una distribución normal, se aplicó la prueba de Shapiro--Wilk a cada una de ellas.
Dado el tamaño de la muestra, se utilizó una submuestra aleatoria de 5000 valores, garantizando la reproducibilidad del análisis.

Los resultados indican que todas las variables cuantitativas no siguen una distribución normal (p ≤ 0.05).
Este comportamiento es especialmente evidente en las variables relacionadas con conteos y montos económicos, las cuales presentan distribuciones asimétricas con colas largas hacia la derecha.
Algunas variables continuas, como la duración de las películas o el promedio de votos, muestran un comportamiento más cercano a la normalidad, aunque no completamente normal debido a la presencia de valores extremos y a la alta variabilidad de los datos.

Debido a su naturaleza discreta y asimétrica, no es apropiado asumir normalidad para las variables de conteo, por lo que en análisis posteriores es recomendable emplear métodos no paramétricos o transformaciones adecuadas de los datos.

b)Variables Cualitativas

```{r 4}
### 3b. Tablas de Frecuencia (Variables Cualitativas según clasificación)

# 1. id (Cualitativa categórica ID) - Mostramos solo las primeras 10 para verificar
cat("\nVariable: id (Top 10)\n")
print(head(sort(table(movies$id), decreasing = TRUE), 10))

# 2. genres
cat("\nVariable: genres (Top 10 combinaciones)\n")
print(head(sort(table(movies$genres), decreasing = TRUE), 10))

# 3. homePage
cat("\nVariable: homePage (Top 10)\n")
print(head(sort(table(movies$homePage), decreasing = TRUE), 10))

# 4. productionCompany
cat("\nVariable: productionCompany (Top 10)\n")
print(head(sort(table(movies$productionCompany), decreasing = TRUE), 10))

# 5. productionCompanyCountry
cat("\nVariable: productionCompanyCountry (Top 10)\n")
print(head(sort(table(movies$productionCompanyCountry), decreasing = TRUE), 10))

# 6. productionCountry
cat("\nVariable: productionCountry (Top 10)\n")
print(head(sort(table(movies$productionCountry), decreasing = TRUE), 10))

# 7. video (Cualitativa binaria)
cat("\nVariable: video (Binaria)\n")
print(table(movies$video))

# 8. director
cat("\nVariable: director (Top 10)\n")
print(head(sort(table(movies$director), decreasing = TRUE), 10))

# 9. actors
cat("\nVariable: actors (Top 10 combinaciones)\n")
print(head(sort(table(movies$actors), decreasing = TRUE), 10))

# 10. actorsPopularity (Nota: Aunque es numérica en esencia, la clasificaste como cualitativa)
cat("\nVariable: actorsPopularity (Top 10)\n")
print(head(sort(table(movies$actorsPopularity), decreasing = TRUE), 10))

# 11. actorsCharacter
cat("\nVariable: actorsCharacter (Top 10)\n")
print(head(sort(table(movies$actorsCharacter), decreasing = TRUE), 10))

# 12. originalTitle
cat("\nVariable: originalTitle (Top 10)\n")
print(head(sort(table(movies$originalTitle), decreasing = TRUE), 10))

# 13. title
cat("\nVariable: title (Top 10)\n")
print(head(sort(table(movies$title), decreasing = TRUE), 10))

# 14. originalLanguage
cat("\nVariable: originalLanguage (Top 10)\n")
print(head(sort(table(movies$originalLanguage), decreasing = TRUE), 10))

# 15. releaseDate
cat("\nVariable: releaseDate (Top 10)\n")
print(head(sort(table(movies$releaseDate), decreasing = TRUE), 10))
```

1.  Variables de Identificación y Dispersión (id, title, originalTitle) Observación: En estas variables, casi todas las frecuencias son 1.

Explicación: Esto es el comportamiento esperado para etiquetas de identificación únicas.
Confirma que el dataset no tiene registros duplicados significativos, aunque existen títulos genéricos como "Arena" o "Blackout" que se repiten un par de veces por ser nombres comunes para distintas producciones.

2.  Géneros y Contenido (genres) Dominancia: El género más frecuente es el Documental (1912), seguido por el Drama (1654) y la Comedia (1185).

Explicación: El dataset tiene un sesgo hacia contenido informativo o de no-ficción.
Las combinaciones de géneros (como "Comedy\|Drama") son menos frecuentes que los géneros puros.

3.  Presencia Web y Datos Faltantes (homePage, productionCompany, actors) Valores Vacíos: Existe una cantidad masiva de datos faltantes (campos en blanco ""). Por ejemplo, 8,476 películas no tienen homePage y 5,200 no listan una productionCompany.

Explicación: Esto indica que el dataset contiene muchas producciones independientes, antiguas o de bajo presupuesto que no tienen una huella digital estructurada o registros corporativos completos en la base de datos de origen.

4.  Distribución Geográfica y Lingüística (productionCountry, originalLanguage) Concentración: El idioma predominante es el Inglés (en: 4194), seguido a gran distancia por el Francés (fr: 824) y el Español (es: 814).

Producción: Estados Unidos (US) es el principal productor (850 películas identificadas), pero hay una gran presencia de países europeos y latinoamericanos (BR, FR, GB).

Explicación: Aunque el mercado anglosajón lidera, el dataset tiene una diversidad internacional considerable, especialmente de mercados europeos y brasileños.

5.  Personal y Reparto (director, actors, actorsCharacter) Director: La mayoría de los directores aparecen solo una vez (frecuencia 1), lo que muestra una gran diversidad de autores.

Actores: Un alto número de registros (2522) no tiene actores listados.
En actorsCharacter, el uso frecuente de la etiqueta "Self" refuerza la observación de que gran parte del contenido son documentales donde las personas aparecen como ellas mismas.

6.  Variable Binaria (video) Resultado: Todos los registros (9892) marcaron FALSE.

Explicación: Esta variable es "constante" en este set de datos.
Significa que ninguna de las entradas está clasificada específicamente como un "video" (posiblemente refiriéndose a material extra o formatos musicales), o que el campo no fue llenado para esta muestra.

7.  Fechas de Estreno (releaseDate) Tendencia: Las fechas con mayor frecuencia se concentran a finales de 2025 e inicios de 2026.

Explicación: Esto sugiere que el dataset está compuesto principalmente por estrenos recientes o futuros, funcionando como un catálogo de lanzamientos próximos.
